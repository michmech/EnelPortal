function start(){	var xml=$("#txtXml").val();	Xonomy.render(xml, document.getElementById("editor"), docSpec);	// $(document).keyup(function(e){		// if(e.keyCode==27) parent.closeEditor();	// });}function beforeSave(){	var xml=Xonomy.harvest();	$("#txtXml").val(xml);}var docSpec={	onchange: function(){},	validate: function(jsElement){		if(typeof(jsElement)=="string") jsElement=Xonomy.xml2js(jsElement);		var valid=true;		var elementSpec=this.elements[jsElement.name];		if(elementSpec.validate) {			valid=elementSpec.validate(jsElement); //validate the element		}		for(var iAttribute=0; iAttribute<jsElement.attributes.length; iAttribute++) {			var jsAttribute=jsElement.attributes[iAttribute];			var attributeSpec=elementSpec.attributes[jsAttribute.name];			if(attributeSpec.validate) {				if(!attributeSpec.validate(jsAttribute)) valid=false; //validate the attribute			}		}		for(var iChild=0; iChild<jsElement.children.length; iChild++) {			if(jsElement.children[iChild].type=="element") {				var jsChild=jsElement.children[iChild];				if(!this.validate(jsChild)) valid=false; //recurse to the child element			}		}		if(!jsElement.parent()) {			$("#butSave").prop("disabled", !valid);		}		return valid;	},	elements: {		"admin": {			menu: [{				caption: "Add <user>",				action: Xonomy.newElementChild,				actionParameter: "<user email='' password='' isAdmin='0'/>",			}],		},		"user": {			canDropTo: ["admin"],			menu: [{				caption: "Add @password",				action: Xonomy.newAttribute,				actionParameter: {name: "password", value: ""},				hideIf: function(jsMe){ return jsMe.hasAttribute("password"); },			}, {				caption: "Delete",				action: Xonomy.deleteElement,			}],			attributes: {				"email": {					asker: Xonomy.askString,					validate: function(jsMe){						if(jsMe.value=="") { Xonomy.warnings.push({htmlID: jsMe.htmlID, text: "This attribute should not be empty."}); return false; }						return true;					},				},				"password": {					asker: Xonomy.askString,					validate: function(jsMe){						if(jsMe.value=="") { Xonomy.warnings.push({htmlID: jsMe.htmlID, text: "This attribute should not be empty."}); return false; }						return true;					},					menu: [{						caption: "Delete",						action: Xonomy.deleteAttribute,					}],				},				"isAdmin": {					asker: Xonomy.askPicklist,					askerParameter: [{value: "0", caption: "no"}, {value: "1", caption: "yes"}],				}			},					},	},};